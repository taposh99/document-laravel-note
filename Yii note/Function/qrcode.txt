
    public function actionUpdateAllQrStrings()
        {
            $distributors = Distributor::model()->findAll();

            if (!empty($distributors)) {
                foreach ($distributors as $distributor) {
                    if (!empty($distributor->id)) {
                        $encodedId = base64_encode($distributor->id);
                        $qrString = 'http://192.168.1.184:81/sharif_metal/plumber/plumber/registration?id=' . $encodedId;
                        $distributor->qrstring = $qrString;
                        $distributor->save(false, ['qrstring']); 
                    }
                }
                echo CJSON::encode([
                    'status' => 'success',
                    'message' => 'All QR codes updated successfully!',
                ]);
            } else {
                echo CJSON::encode([
                    'status' => 'error',
                    'message' => 'No distributors found!',
                ]);
            }
            
            Yii::app()->end();
        }



    public function actionUpdatePreviousSpentLeaveData()
    {
        $leaveRecords = EmpLeavesNormal::model()->findAllByAttributes(['is_approved' => 16]);
        foreach ($leaveRecords as $leave_data) {
            if (!$leave_data) {
                continue;
            }
            $applied_days = $leave_data->applied_days;
            $lhRecord = LhAmountProllNormal::model()->findByAttributes([
                'employee_id' => $leave_data->emp_id,
                'lh_proll_normal_id' => $leave_data->lh_proll_normal_id,
                'is_active' => 1
            ]);

            if ($lhRecord) {
                $lhRecord->spent_leave += $applied_days;
                $lhRecord->save();
            }
        }

        echo "All previous data updated successfully.";
    }